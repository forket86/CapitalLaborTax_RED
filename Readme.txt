Readme File: Replication Package for “Capital and Labor Taxes
                with Costly State Contingency”

           Alex Clymo, Andrea Lanteri, and Alessandro T. Villa

                            September 2023
1     Description of Package Contents
The codes in this replication package were used to generate the numerical results and data in the
paper and in the Online Appendix. All files are run in Matlab, apart from one data script which
is run in Stata. All figures and tables are generated by one single Matlab file with the exceptions
of table 1 which contains parameter values. The replication package is organized in the following
main directories:

    1. “Root” (./) contains the programs to reproduce all figures and tables. The following sub-
      folders contain the codes to solve the models.

    2. “Functions” (./Functions/) contains functions (e.g., model first-order conditions) that may
      be used by the root programs.

    3. “Figures” (./Figures/) all figures are automatically saved in this folder in FIG format (can
      be opened with Matlab).

    4. “Tables” (./Tables/) all tables are automatically saved in this folder in TEX format.

    5. “Utils” (./Utils/) contains utility functions (e.g., Gaussian quadrature) that may be used
      by the root programs.

    6. “FC” (./FC/) contains the code to solve the full commitment problem without debt, without
      cost of state contingency. This folder includes the code to solve two Ramsey problems: (i)
      with full state contingent capital and labor taxes and (ii) with full state contingent labor
      tax and predetermined capital tax.

    7. “FC Debt” (./FC Debt/) contains the code to solve the full commitment problem with debt
      and costly state contingency on both labor and capital taxes.

    8. “FC BB” (./FC BB/) contains the code to solve the the full commitment problem without
      debt (the government faces a balanced budget constraint) and costly state contingent labor
      tax and predetermined capital tax. This folder also includes the code to solve the models
      with TFP shocks and asymmetric costs.

    9. “LTC BB” (./LTC BB/) contains the code to solve the optimal time consistent policy with-
      out debt (the government faces a balanced budget constraint) and costly state contingent
      labor tax and predetermined capital tax.

 10. “Data” (./Data/) contains the raw data, codes to process and analyse the data, and to
      produce all data figures and moments.



                                                 1
 11. “Two Period” (./Two Period/) contains the codes to solve the two period model from
      Appendix B.


2     Data Availability Statement and Data Citations
In this replication package, we provide all data used in this paper. Specifically, we provide
data on fiscal variables in the United States from the Bureau of Economic Analysis (BEA) and the 
defence news shock series of Ramey and Zubairy (2018). Details of the data and its sources
are given in Appendix D of the paper.
All data used in this paper are publicly and freely available and can be accessed either via the BEA or FRED, with 
the exception of the defence news shock series from Ramey and Zubairy (2018), which are available 
from their online appendices. 


3     Code Execution Instructions
Copy and paste the replication folder. All paths in Matlab are expressed in relative terms, hence
there is no need to change them. For the single Stata file, the path must be manually edited by
the user in the script itself. For full replication (replicate workspaces, hence all tables and figures),
run points 1 to 4 of the following list of instructions. For partial replication (replicate only tables
and figures, given the provided workspaces), run point 4 of the following list of instructions.

    1. Quantitative model: Run the following set of instructions to replicate all workspaces
      (note that all workspaces will be saved with the suffix “ temp” not to overwrite the original
      provided workspaces and note also that you need to set the working directory of Matlab to
      each subfolder when launching each file):

          Run “./FC/main.m” to produce “./FC/INIT/FCFARHI.mat.”
          Run “./FC Debt/main.m” to produce “./FC Debt/INIT/openbound35 2.mat.”
          Run “./FC Debt - Farhi/main.m” to produce “./FC Debt - Farhi/INIT/035 Farhi Extreme.mat.”
          Open “./FC BB/launcherNeural2.m.” Set the variable MODEL (line 11) to be 1, 2,
           or 3. These values correspond to the following three models:
           (a) Limited state contingent labor and capital tax with symmetric cost=39.
           (b) Fully state contingent labor tax and limited state contingent capital tax with
                cost=39.
            (c) Fully state contingent capital tax and limited state contingent labor tax with
                cost=39.
           Run the script to produce “./FC BB/INIT/chi0 39 psi0 39.mat,” “./FC BB/INIT/chi0 0dot01 psi0 39
           and “./FC BB/INIT/chi0 39 psi0 0dot01.mat,” respectively.
          Run “./FC BB/launcherNeural2 AsymmetricCost.m” to produce “./FC BB/INIT/chi0 39 psi0 39a2.m


                                                   2
     Run “./FC BB/launcherNeural2LowPers.m” to produce “./FC BB/INIT/LowPers39 39.mat.”
     Open “./FC BB/launcherNeuralTFP2.m.” Set the variable MODEL (line 13) to be 1,
      2, or 3. These values correspond to the following three models:
       (a) Predetermined capital tax and limited state contigent labor tax.
      (b) Limited state contigent labor and capital taxes with symmetric cost 39.
       (c) Limited state contigent labor and capital taxes with symmetric cost 53.
      Run the script to produce “./FC BB/INIT/TFP0dot01 39 Farhi.mat,” “.FC BB/INIT/TFP39.mat,”
      and “./FC BB/INIT/TFP53.mat,” respectively.
     Open “./LTC BB/launcherNeuralGEE.m.” Set the variable MODEL (line 11) to be
      1, or 2. These values correspond to the following two models:
       (a) Optimal time consistent policy with limited state contingent labor and capital tax
           with symmetric cost=2.
      (b) Optimal time consistent policy with limited state contingent labor and capital tax
           with symmetric cost=39.
      Run the script to produce “./FC BB/INIT/CurveGEE/Both/Curve2.mat,” and “./FC
      BB/INIT/CurveGEE/Both/Curve39.mat,” respectively.

2. Two period model:

     All files are in the ./Two Period folder. There are two main scripts, and various
      functions used in the model solution.
     First run main1 solveModel.m to solve the various versions of the model. This saves
      the workspace as results2P.mat.
     Then run main2 plots.m to plot the results, which produces Figure B1.

3. Data:

     All files and raw data are in the ./Data folder. Raw data are in the four subfolders,
      and the subfolder ./RZ raw additionally contains a short script which aggregates the
      RZ data from quarterly to annual frequency. Raw data have been manually saved into
      Matlab data files data.mat and RZ yearly.mat.
     To replicate all procedures and workspaces use the following procedure:
       (a) Run main1 dataprep.m in Matlab to load the raw data and process it. This pro-
           duces Figure D1; a data file for use in the the local projections script; and replicates
           the data moments in the final columns of Tables 2 and 5.



                                              3
           (b) Run main2 estimateLP.do in Stata to run the local projection estimation. This
               produces a data file with the results. Note: The user must manually edit the
               working directory in the code, the local variable “loadpath”, to the path to the
               where this folder is stored on their own machine. Install ivreg2 and ranktest, if
               not installed in your machine, with commands “ssc install ivreg2” and “ssc install
               ranktest.”
           (c) Run main3 plotLP.m in Matlab to plot the local projection results: Figures 6 and
               D2.
           (d) Run ./g process calibration/main gproc.m to estimate the government spending
               process.

    4. Producing tables and figures from the paper: Run the following instruction to repli-
      cate all tables and figures:

          Run main.m to replicate all figures and tables, which are automatically saved in “./fig-
           ures/” and “./tables/,” respectively.


4     Computational Requirements

4.1    Software Requirements

The code for the quantitative model was run using the following hardware and software:

     CPU: 11th Gen Intel(R) Core(TM) i9-11900H @ 2.50GHz, with RAM 32 GB

     Windows 10 Enterprise 22H2

     MATLAB Version 9.14 (R2023a)

         – Curve Fitting Toolbox Version 3.9 (R2023a)
         – Deep Learning Toolbox Version 14.6 (R2023a)
         – Econometrics Toolbox Version 6.2 (R2023a)
         – Optimization Toolbox Version 9.5 (R2023a)
         – Parallel Computing Toolbox Version 7.8 (R2023a)
         – Statistics and Machine Learning Toolbox Version 12.5 (R2023a)

     Stata 17.0 MP-Parallel Edition

         – ivreg2
         – ranktest

    Note that Matlab uses the latex interpreter to generate the text in the figures.

                                                   4
4.2    Runtime

The approximate time to reproduce the analyses is as follows:

     main.m (∼300s)

Additionally, the replication package contains the following files that contains the algorithm to
solve the quantitative model:

     “./FC/main.m” (∼65s)

     “./FC Debt/main.m” (∼5s)

     “./FC Debt - Farhi/main.m” (∼5s)

     “./FC BB/launcherNeural2.m” (∼5s)

     “./FC BB/launcherNeural2 AsymmetricCost.m” (∼5s)

     “./FC BB/launcherNeural2LowPers.m” (∼5s)

     “./FC BB/launcherNeuralTFP2.m” (∼5s)

     “./LTC BB/launcherNeuralGEE.m” (∼5s)

The runtime for the two period model is around 60s and data processing codes are all around 5s
or less per script.


4.3    Controlled Randomness

“./FC/main.m” uses random numbers to draw a sequence of government expenditures. The seed
is set through the command “rng(1)” at line 22.


5     List of Tables, Figures, and Corresponding Programs
The following subsections provide further details on the specific programs that produce each
output.


5.1    Tables

There are 7 tables in the paper.

     Table 1. This figure reports the parameter values and does not require any program.

     Table 2. This can be replicated by running main.m. The table is written in the “tables”
      folder with the name “Table2.tex.”

                                               5
    Table 3. This can be replicated by running main.m. The table is written in the “tables”
      folder with the name “Table3.tex.”

    Table 4. This can be replicated by running main.m. The table is written in the “tables”
      folder with the name “Table4.tex.”

    Table 5. This can be replicated by running main.m. The table is written in the “tables”
      folder with the name “Table5.tex.”

    Table C1. This can be replicated by running main.m. The table is written in the “tables”
      folder with the name “TableC1.tex.”

    Table C2. This can be replicated by running main.m. The table is written in the “tables”
      folder with the name “TableC2.tex.”


5.2   Figures

There are 16 figures in the paper:

    Figure 1. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure1.fig.”

    Figure 2. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure2.fig.”

    Figure 3. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure3.fig.”

    Figure 4. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure4.fig.”

    Figure 5. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure5.fig.”

    Figure 6. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure6.fig.”

    Figure 7. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure7.fig.”

    Figure 8. This can be replicated by running main.m. The figure is written in the “figures”
      folder with the name “Figure8.fig.”



                                              6
 Figure 9. This can be replicated by running main.m. The figure is written in the “figures”
  folder with the name “Figure9.fig.”

 Figure 10. This can be replicated by running main.m. The figure is written in the “figures”
  folder with the name “Figure10.fig.”

 Figure B1. This can be replicated by running main.m or Two Period/main2 plots.m. The
  figure is written in the “figures” folder with the names “FigureB1a.fig” and “FigureB1b.fig.”

 Figure C1. This can be replicated by running main.m. The figure is written in the “figures”
  folder with the name “FigureC1.fig.”

 Figure C2. This can be replicated by running main.m. The figure is written in the “figures”
  folder with the name “FigureC2.fig.”

 Figure C3. This can be replicated by running main.m. The figure is written in the “figures”
  folder with the name “FigureC3.fig.”

 Figure D1. This can be replicated by running main.m or Data/main1 dataprep.m. The
  figure is written in the “figures” folder with the name “FigureD1.fig.”

 Figure D2. This can be replicated by running main.m or Data/main3 plotLP.m. The figure
  is written in the “figures” folder with the name “FigureD2.fig.”




                                            7
